<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maktab Test Tizimi</title>
<style>
body{margin:0;font-family:Arial;background:#0f2027;color:#fff}
section{display:none;padding:20px}
.active{display:block}
.topbar{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}
button{padding:10px 18px;border:none;border-radius:8px;cursor:pointer;margin:5px}
input,select,textarea{padding:8px;margin:5px;border-radius:6px;border:none;width:95%}
.card{background:#203a43;padding:12px;border-radius:10px;margin:8px 0;word-wrap:break-word;}
.big-red{background:red;font-size:22px;padding:18px;width:100%;color:white;margin-top:20px}
.test-box{max-height:60vh;overflow-y:auto;background:#203a43;padding:15px;border-radius:10px}
.answer-btn{margin-right:10px;margin-top:5px}
@media(max-width:600px){
button, .answer-btn{width:100%;margin:5px 0}
input,select,textarea{width:100%}
.topbar{flex-direction:column;align-items:flex-start}
.big-red{font-size:20px}
}
</style>
</head>
<link rel="stylesheet" href="style.css">

<body>

<section id="start" class="active">
<h1>Boshlash</h1>
<button onclick="go('school')">Boshlash</button>
</section>

<section id="school">
<h2>Maktab nomi</h2>
<input id="schoolName" placeholder="Masalan: 34-maktab">
<button onclick="saveSchool()">Davom etish</button>
</section>

<section id="classes">
<div class="topbar">
<h2>Sinflar</h2>
<button onclick="go('add')">➕ O‘quvchi qo‘shish</button>
</div>
<div id="classList"></div>
<button class="big-red" onclick="startTest()">TESTNI BOSHLASH</button>
</section>

<section id="add">
<h2>O‘quvchi qo‘shish</h2>
<input id="ism" placeholder="Ism">
<input id="fam" placeholder="Familiya"><br>
<select id="sinf">
<option>6</option><option>7</option><option>8</option>
<option>9</option><option>10</option><option>11</option>
</select>
<select id="harf">
<option>A</option><option>B</option><option>D</option>
</select><br>
<button onclick="addStudent()">Saqlash</button>
<button onclick="go('classes')">⬅ Orqaga</button>
</section>

<section id="students">
<h2>O‘quvchini tanlang</h2>
<div id="studentList"></div>
</section>

<section id="test">
<h2 id="testTitle"></h2>
<div class="test-box" id="allQuestions"></div>
<button class="big-red" onclick="finishTest()">Testni Tugatish</button>
</section>

<section id="login">
<h2>ID kiriting</h2>
<input id="adminInput" placeholder="ID">
<button onclick="checkID()">Kirish</button>
</section>

<section id="results">
<h2>Natijalar</h2>
<div id="resultBox"></div>
</section>

<script>
const SECRET_ID = "Abror 13";
let db = JSON.parse(localStorage.getItem("db")) || {};
let currentStudent = null;
let currentClass = "";

// 20 savol, uzun va batafsil
const questions = [
"Siz texnologiyalarni chuqur o‘rganishni xohlaysizmi? Misol uchun robototexnika, dasturlash yoki kompyuter tizimlari.",
"Murakkab masalalarni hal qilish sizga yoqadimi? Logik muammolar va algoritmlarni yechish.",
"Kompyuter bilan ishlashdan zavqlanasizmi? Dasturiy ta'minot va ilovalarni yaratish.",
"Dasturlashni o‘rganishga qiziqasizmi? Web, mobil yoki o‘yinlar dasturlash.",
"Texnik muammolarni tuzatishni yoqtirasizmi? Masalan, kompyuter yoki elektron qurilmalarni ta'mirlash.",
"Mustaqil ishlash sizga qulaymi? O‘z vaqtida va o‘z nazoratingiz bilan ishlash.",
"Mantiqiy fikrlashni yoqtirasizmi? Muammolarni tizimli va izchil yechish.",
"Yangi bilimlarni tez o‘zlashtirasizmi? Kitoblar, onlayn kurslar va tajriba orqali.",
"Matematikaga qiziqasizmi? Sonlar, formula va hisoblash muammolari.",
"Texnika sizni qiziqtiradimi? Elektronika, mexanika va robototexnika.",
"Odamlarga yordam berishni xohlaysizmi? Psixologiya, tibbiyot yoki jamiyat xizmatlari.",
"Jamoada ishlash sizga yoqadimi? Loyihalar va guruh ishlarida qatnashish.",
"Tibbiyot sizni qiziqtiradimi? Shifokor, hamshira, laboratoriya ishlariga qiziqish.",
"Stressga chidamlisizmi? Murakkab vaziyatlarda barqaror bo‘lish.",
"Sport bilan shug‘ullanishni xohlaysizmi? Fiziologiya, trenerlik va sog‘lom turmush.",
"Tez qaror qabul qila olasizmi? Rahbarlik, menejment yoki tadbirkorlik.",
"Biologiya yoqadimi? Tabiyat, hayvonot va o‘simliklar haqida.",
"Diqqatni uzoq jamlay olasizmi? Tadqiqot, ilmiy ishlar yoki murakkab loyihalar.",
"Mas’uliyatni o‘z zimmangizga olasizmi? Rahbarlik yoki muhim qarorlar qabul qilish.",
"Kelajak kasbingiz haqida o‘ylaganmisiz? O‘z qiziqishlaringiz va kuchli tomonlaringiz."
];

function go(id){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

function saveSchool(){
let s = schoolName.value.trim();
if(!s) return alert("Maktab nomini yoz");
localStorage.setItem("school", s);
if(!db[s]) db[s] = {};
save();
loadClasses();
go('classes');
}

function addStudent(){
let s = localStorage.getItem("school");
let key = sinf.value + "-" + harf.value;
if(!db[s][key]) db[s][key] = [];
db[s][key].push({ism:ism.value,fam:fam.value,done:false,answers:[]});
save();
alert("Qo‘shildi");
ism.value=""; fam.value="";
loadClasses();
}

function loadClasses(){
let s = localStorage.getItem("school");
classList.innerHTML="";
for(let c in db[s]){
classList.innerHTML += `<div class="card"><b>${c}</b> — ${db[s][c].length} o‘quvchi</div>`;
}
}

function startTest(){
let s = localStorage.getItem("school");
studentList.innerHTML="";
for(let c in db[s]){
db[s][c].forEach(st=>{
if(!st.done){
let b=document.createElement("button");
b.textContent=`${st.ism} ${st.fam} (${c})`;
b.onclick=()=>selectStudent(st,c);
studentList.appendChild(b);
}
});
}
go('students');
}

function selectStudent(st,c){
currentStudent = st;
currentClass = c;
showAllQuestions();
go('test');
}

function showAllQuestions(){
const container = document.getElementById("allQuestions");
container.innerHTML = "";
questions.forEach((q,i)=>{
let div = document.createElement("div");
div.className="card";
let p = document.createElement("p");
p.innerText = q;
div.appendChild(p);
let btns = document.createElement("div");
["Ha","Yo‘q","Bilmayman"].forEach(a=>{
let b = document.createElement("button");
b.className="answer-btn";
b.textContent = a;
b.onclick = ()=>{
currentStudent.answers[i]=a;
b.disabled=true;
};
btns.appendChild(b);
});
div.appendChild(btns);
container.appendChild(div);
});
}

function finishTest(){
currentStudent.done = true;
save();
alert("Test tugadi! Natijani ko‘rish uchun ID bilan kiring.");
go('login');
}

function checkID(){
if(adminInput.value === SECRET_ID){
showResults();
go('results');
}else{
alert("ID noto‘g‘ri");
}
}

function showResults(){
resultBox.innerHTML="";
let s = localStorage.getItem("school");
if(!db[s]) return alert("Hech kim hali test topshirmagan");
for(let c in db[s]){
db[s][c].forEach(st=>{
let xulosa = calculateCareer(st.answers);
resultBox.innerHTML += `
<div class="card">
<b>${c}</b><br>
${st.ism} ${st.fam}<br>
Javoblar (${st.answers.length}/20):<br>${st.answers.join(", ")}<br>
<b>Xulosa:</b> ${xulosa}
</div>`;
});
}
}

function calculateCareer(ans){
let tech = ans.slice(0,10).filter(a=>"Ha"===a).length;
let social = ans.slice(10,15).filter(a=>"Ha"===a).length;
let science = ans.slice(15,20).filter(a=>"Ha"===a).length;
if(tech>=5) return "Texnologiya va dasturlashga qiziqadi";
if(social>=3) return "Jamiyat va odamlar bilan ishlashga qiziqadi";
if(science>=3) return "Tabiat, biologiya va ilmiy ishlar qiziqtiradi";
return "Turli sohalarga qiziqishi bor";
}

function save(){
localStorage.setItem("db", JSON.stringify(db));
}
</script>

</body>
</html>
